<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Event Map — Welcome</title>
  <meta name="description" content="Welcome to the Event Map" />
  <meta name="theme-color" content="#0ea5e9" />
  <style>
    :root{
      --bg1:#0b1220; --bg2:#0f172a; --ring:rgba(255,255,255,.14);
      --fg:#e5eefc; --muted:#93a4c3; --brand:#38bdf8; --brand2:#22c55e;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;color:var(--fg);
      font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica Neue,Arial,Noto Sans,Apple Color Emoji,Segoe UI Emoji;
      background:
        radial-gradient(1400px 800px at 10% -10%, #0ea5e92e, transparent 70%),
        radial-gradient(1200px 700px at 110% 10%, #22c55e22, transparent 70%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow:hidden;
    }
    .dots{
      position:fixed; inset:-20vmax;
      background-image:
        radial-gradient(circle at 20% 40%, rgba(255,255,255,.08) 0 1px, transparent 1px),
        radial-gradient(circle at 40% 70%, rgba(255,255,255,.06) 0 1px, transparent 1px),
        radial-gradient(circle at 70% 30%, rgba(255,255,255,.07) 0 1px, transparent 1px);
      background-size:26px 26px,32px 32px,28px 28px;
      animation:float 18s linear infinite; pointer-events:none; filter:blur(.5px); opacity:.55;
    }
    @keyframes float{from{transform:translate3d(0,0,0)}to{transform:translate3d(-40px,-30px,0)}}
    .wrap{position:relative;height:100%;display:grid;place-items:center;padding:clamp(16px,4vw,48px)}
    .stack{width:min(1100px,92vw);display:flex;flex-direction:column;gap:clamp(8px,1.4vh,14px);line-height:1.05}
    .line{
      display:block;font-weight:800;letter-spacing:-.02em;
      font-size:clamp(26px,6.4vw,72px);opacity:.75;transform-origin:left center;transition:opacity .4s ease;
    }
    .line.active{opacity:1;animation:pulse 1.4s ease-in-out infinite;text-shadow:0 6px 24px rgba(56,189,248,.25)}
    @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.06)}100%{transform:scale(1)}}
    .en{color:#a5f3fc}.de{color:#86efac}.fr{color:#c7d2fe}.it{color:#f9a8d4}.ru{color:#e2e8f0}
    .counter{
      position:fixed;top:max(16px,env(safe-area-inset-top));right:max(16px,env(safe-area-inset-right));
      display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:999px;
      background:linear-gradient(180deg,rgba(255,255,255,.12),rgba(255,255,255,.06));
      backdrop-filter:blur(10px) saturate(140%);border:1px solid var(--ring);box-shadow:0 6px 28px rgba(0,0,0,.25);font-weight:700;user-select:none;
    }
    .counter small{color:var(--muted);font-weight:600;letter-spacing:.04em}
    .bubble{
      display:inline-grid;place-items:center;width:44px;height:44px;border-radius:50%;
      background:radial-gradient(100% 100% at 30% 20%,#fff,#dbeafe);color:#0b1220;font-size:22px;font-weight:900;
      box-shadow:0 6px 24px rgba(59,130,246,.45);transition:transform .25s ease;
    }
    .bubble.ping{animation:pop .6s ease}
    @keyframes pop{0%{transform:scale(1.1)}100%{transform:scale(1)}}
    .hint{position:fixed;left:50%;transform:translateX(-50%);bottom:max(14px,env(safe-area-inset-bottom));color:var(--muted);font-size:12px;letter-spacing:.02em;opacity:.85}
    .hint a{color:#a5f3fc;text-underline-offset:2px}
    @media (max-width:640px){.line{font-size:clamp(22px,8.5vw,40px)}.counter{padding:8px 12px}.bubble{width:40px;height:40px;font-size:20px}}
    @media (prefers-reduced-motion:reduce){.line.active{animation:none}.dots{animation:none}.bubble.ping{animation:none}}
  </style>
</head>
<body>
  <div class="dots" aria-hidden="true"></div>

  <div class="counter" aria-live="polite" aria-atomic="true">
    <small>Start in</small><span id="count" class="bubble">3</span>
  </div>

  <main class="wrap">
    <section class="stack" aria-label="welcome translations">
      <span class="line en">Welcome to the Event Map</span>
      <span class="line de">Willkommen zur Event-Karte</span>
      <span class="line fr">Bienvenue sur la carte des événements</span>
      <span class="line it">Benvenuto nella mappa degli eventi</span>
      <span class="line ru">Добро пожаловать на карту событий</span>
    </section>
  </main>

  <p class="hint">Redirect in <span id="hint-s">3</span>s · <a href="#" id="stay">stay here</a></p>

  <noscript><style>.counter,.hint{display:none}</style></noscript>

  <script>
    // ===== настройки =====
    const REDIRECT_TARGET = "https://ch.the-event-map.com";
    const DURATION_SEC = 3;

    // если остался ?stay=1 от старой версии — убрать его, чтобы на перезагрузке таймер снова работал
    (() => {
      const u = new URL(window.location.href);
      if (u.searchParams.has("stay")) {
        u.searchParams.delete("stay");
        const qs = u.searchParams.toString();
        history.replaceState(null, "", u.pathname + (qs ? `?${qs}` : "") + u.hash);
      }
    })();

    // поочерёдная пульсация строк
    const lines = Array.from(document.querySelectorAll(".line"));
    let idx = 0;
    function setActive(i){ lines.forEach((el,j)=> el.classList.toggle("active", j===i)); }
    setActive(0);
    const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
    let cycleTimer = prefersReduced ? null : setInterval(()=>{ idx=(idx+1)%lines.length; setActive(idx); }, 1400);

    // счётчик и редирект
    const countEl = document.getElementById("count");
    const hintSEl = document.getElementById("hint-s");
    const stayEl  = document.getElementById("stay");
    let cancelRedirect = false;
    let n = DURATION_SEC;

    function renderCount(){
      countEl.textContent = n;
      hintSEl.textContent = n;
      countEl.classList.remove("ping"); void countEl.offsetWidth; countEl.classList.add("ping");
    }
    renderCount();

    stayEl.addEventListener("click", (e)=>{
      e.preventDefault();
      cancelRedirect = true;
      const hint = document.querySelector(".hint");
      hint.textContent = "Redirect cancelled. Refresh the page to start again.";
    });

    const tick = setInterval(()=>{
      if (n > 1){
        n -= 1; renderCount();
      } else {
        clearInterval(tick);
        if (!cancelRedirect) window.location.href = REDIRECT_TARGET + window.location.search + window.location.hash;

      }
    }, 1000);
  </script>
</body>
</html>
